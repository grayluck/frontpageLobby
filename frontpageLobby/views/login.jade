extends layout

block header
    link(
        rel="stylesheet",
        href="/stylesheets/login.css")

block content
    .container
        form(class="form-login" action="/api/userLogIn" method="post")
            h2(class="form-login-heading") User login

            label(for="inputUsername" class="sr-only") Username
            input(type="input" id="username" name="username" class="form-control" placeholder="Username" required autofocus)

            label(for="inputPassword" class="sr-only") Password
            input(type="password" id="password" name="password" class="form-control" placeholder="Password" required)

            div(class="btn btn-lg btn-primary btn-block" id='submit') Sign in

    +alert('alert', 'Login failed.')

    script.
        var token = utils.getCookie('token');
        console.log('token: ' + token);

        $('#submit').click(function() {
            $.ajax({
                url: '/api/userLogIn',
                type: 'POST',
                data: {
                    username: $('#username').val(),
                    password: $('#password').val()
                },
                success: function(result) {
                    if(result.error) {
                        $('#alert').modal({
                            backdrop: true
                        });
                    } else {
                        utils.setCookie('token', result.token, 100);
                        window.location.href = '/';
                    }
                }
            });
        });

